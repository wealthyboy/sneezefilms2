!function(a){"use strict";a(".isw_items").sortable({cursor:"move",stop:function(b,c){var d=a(".isw_items > .isw_element").length;if(d>0){var e=0;a(".isw_items > .isw_element").each(function(){var b=a(this),c=b.attr("data-id");b.find("[name]").each(function(){var b=a(this).attr("name");a(this).attr("name",b.replace("["+c+"]","["+e+"]"))}),b.attr("data-id",e),e++})}}});var b=!1;a(document).on("click",".isw_add_new_btn",function(){if(b===!0)return!1;b=!0;var c=a(this);c.addClass("loading").attr("disabled",!0);var d=a(this).parent().next(),e=d.find(".isw_element").length,f={action:"insight_sw_get_fields"};return a.post(isw.ajax,f,function(a){if(a){a=a.replace(/\%%/g,e);var f='<div class="isw_element" data-id="'+e+'"><div class="isw_element_heading"><a href="#" class="isw_attribute_title">Add New Attribute</a><a href="#" class="isw_remove"><i class="dashicons dashicons-trash"></i></a><a href="#" class="isw_reorder"><i class="dashicons dashicons-move"></i></a><a href="#" class="isw_slidedown"><i class="dashicons dashicons-arrow-down-alt2"></i></a><div class="isw_clear"></div></div><div class="isw_element_content">'+a+"</div></div>",g=d.append(f);g.find('.isw_element[data-id="'+e+'"] .isw_slidedown').trigger("click"),b=!1,c.removeClass("loading").attr("disabled",!1)}else alert("Error!"),b=!1}),!1}),a(document).on("click",".isw_slidedown",function(){var b=a(this).closest(".isw_element").find(".isw_element_content"),c=a(this).find("i");return c.hasClass("dashicons-arrow-down-alt2")?(c.removeClass("dashicons-arrow-down-alt2").addClass("dashicons-arrow-up-alt2"),b.slideDown()):(c.removeClass("dashicons-arrow-up-alt2").addClass("dashicons-arrow-down-alt2"),b.slideUp()),!1}),a(document).on("click",".isw_attribute_title",function(){return a(this).parent().find(".isw_slidedown").trigger("click"),!1}),a(document).on("click",".isw_reorder",function(){return!1}),a(document).on("click",".isw_remove",function(){if(confirm("Do you want to remove this swatch ?")){a(this).closest(".isw_element ").remove();var b=a(".isw_items > .isw_element").length;if(b>0){var c=0;a(".isw_items > .isw_element").each(function(){var b=a(this),d=b.attr("data-id");b.find("[name]").each(function(){var b=a(this).attr("name");a(this).attr("name",b.replace("["+d+"]","["+c+"]"))}),b.attr("data-id",c),c++})}}return!1}),a(document).on("change",".isw_attr_select",function(){var b=a(this).closest(".isw_element"),c=b.attr("data-id"),d=b.find('select[name^="isw_attr"] option:selected').attr("value"),e=b.find('select[name^="isw_style"] option:selected').attr("value");if(""==d)return alert("Please select attribute."),b.find(".isw_terms").html(""),!1;if(b.parent().find('select[name^="isw_attr"] option[value="'+d+'"]:selected').length>1)return alert("You have already set this attribute style."),b.find(".isw_terms").html(""),b.find('select[name^="isw_attr"] option:first').prop("selected",!0),!1;b.block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var f={action:"insight_sw_get_terms",taxonomy:d,style:e};a.post(isw.ajax,f,function(d){d?(d=d.replace(/\%%/g,c),b.find(".isw_terms").html(d),b.find(".isw_color").each(function(){a(this).wpColorPicker({defaultColor:!0,hide:!0})}),b.unblock()):alert("Error!")})}),a(document).on("click",".isw_upload_media",function(){var b,c=a(this),d=c.parent().prev();return b?void b.open():(b=wp.media({title:c.data("choose"),button:{text:c.data("update"),close:!1}}),b.on("select",function(){var a=b.state().get("selection").first();b.close(),d.find("input").val(a.attributes.url)}),b.open(),!1)}),a("#isw_manager .isw_color").each(function(){a(this).wpColorPicker({defaultColor:!0,hide:!0})})}(jQuery);